{"version":3,"sources":["styles.js"],"names":["zoomScale","scale","linear","domain","strokeScale","range","fontScale","notFocusedColor","utils","pixels","zoom","min","normal","max","strokeWidth","display","fontSize","data","Math","floor","defineSegmentCircleMarker","segment","radius","fillColor","markerId","getId","svg","append","attr","focused","wireframeVertices","cx","cy","r","fill","wireframeEdges","stroke","stopsMerged","point","index","isFocused","owner","containsBoardPoint","containsAlightPoint","containsTransferPoint","visibility","containsSegmentEndPoint","stopsPattern","exports","stops_pattern","busOnly","getPatterns","forEach","pattern","route","route_type","places","multipointsMerged","multipointsPattern","labels","orientations","segmentLabels","color","background","segments","type","patterns","route_short_name","toLowerCase","substring","getColor","startsWith","frequency","average","mode","envelope","segmentsFront","segmentsHalo","computeLineWidth","segmentLabelContainers","parent","rx","ry","wireframe_edges","wireframe_vertices","stops_merged","multipoints_merged","multipoints_pattern","segments_front","segments_halo","segment_labels","segment_label_containers"],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA;;;;AAIA,IAAMA,YAAY,YAAGC,KAAH,CAASC,MAAT,GAAkBC,MAAlB,CAAyB,CAAC,IAAD,EAAO,CAAP,EAAU,CAAV,CAAzB,CAAlB;AACA,IAAMC,cAAc,YAAGH,KAAH,CAASC,MAAT,GAAkBC,MAAlB,CAAyB,CAAC,IAAD,EAAO,CAAP,EAAU,CAAV,CAAzB,EAAuCE,KAAvC,CAA6C,CAAC,CAAD,EAAI,EAAJ,EAAQ,EAAR,CAA7C,CAApB;AACA,IAAMC,YAAY,YAAGL,KAAH,CAASC,MAAT,GAAkBC,MAAlB,CAAyB,CAAC,IAAD,EAAO,CAAP,EAAU,CAAV,CAAzB,EAAuCE,KAAvC,CAA6C,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,CAA7C,CAAlB;;AAEA,IAAIE,kBAAkB,SAAtB;;AAEA;;;;AAIA,IAAMC,QAAQ;AACZC,UAAQ,gBAAUC,IAAV,EAAgBC,GAAhB,EAAqBC,MAArB,EAA6BC,GAA7B,EAAkC;AACxC,WAAOb,UAAUK,KAAV,CAAgB,CAACM,GAAD,EAAMC,MAAN,EAAcC,GAAd,CAAhB,EAAoCH,IAApC,CAAP;AACD,GAHW;AAIZI,eAAa,qBAAUC,OAAV,EAAmB;AAC9B,WAAOX,YAAYW,QAAQd,KAApB,CAAP;AACD,GANW;AAOZe,YAAU,kBAAUD,OAAV,EAAmBE,IAAnB,EAAyB;AACjC,WAAOC,KAAKC,KAAL,CAAWb,UAAUS,QAAQd,KAAlB,CAAX,CAAP;AACD,GATW;AAUZmB,6BAA2B,mCAAUL,OAAV,EAAmBM,OAAnB,EAA4BC,MAA5B,EAAoCC,SAApC,EAA+C;AACxE,QAAIC,WAAW,kBAAkBH,QAAQI,KAAR,EAAjC;AACAV,YAAQW,GAAR,CAAYC,MAAZ,CAAmB,MAAnB,EAA2BA,MAA3B,CAAkC,YAAlC,EACGC,IADH,CACQ,IADR,EACcJ,QADd,EAEGI,IAFH,CAEQ,MAFR,EAEgBN,MAFhB,EAGGM,IAHH,CAGQ,MAHR,EAGgBN,MAHhB,EAIGM,IAJH,CAIQ,aAJR,EAIuBN,SAAS,CAJhC,EAKGM,IALH,CAKQ,cALR,EAKwBN,SAAS,CALjC,EAMGM,IANH,CAMQ,aANR,EAMuB,gBANvB,EAOGD,MAPH,CAOU,YAPV,EAQGC,IARH,CAQQ,IARR,EAQcN,MARd,EASGM,IATH,CASQ,IATR,EAScN,MATd,EAUGM,IAVH,CAUQ,GAVR,EAUaN,MAVb,EAWGM,IAXH,CAWQ,MAXR,EAWgBP,QAAQQ,OAAR,GAAkBN,SAAlB,GAA8BhB,eAX9C;;AAaA,WAAO,UAAUiB,QAAV,GAAqB,GAA5B;AACD;AA1BW,CAAd;;AA6BA;;;;AAIA,IAAMM,oBAAoB;AACxBC,MAAI,CADoB;AAExBC,MAAI,CAFoB;AAGxBC,KAAG,CAHqB;AAIxBC,QAAM;AAJkB,CAA1B;;AAOA,IAAMC,iBAAiB;AACrBC,UAAQ,MADa;AAErB,kBAAgB,CAFK;AAGrB,sBAAoB,SAHC;AAIrBF,QAAM;AAJe,CAAvB;;AAOA;;;;AAIA,IAAMG,cAAc;AAClBH,QAAM,cAAUnB,OAAV,EAAmBuB,KAAnB,EAA0BC,KAA1B,EAAiC/B,KAAjC,EAAwC;AAC5C,WAAO,MAAP;AACD,GAHiB;AAIlByB,KAAG,WAAUlB,OAAV,EAAmBuB,KAAnB,EAA0BC,KAA1B,EAAiC/B,KAAjC,EAAwC;AACzC,WAAOA,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,EAA/B,EAAmC,EAAnC,CAAP;AACD,GANiB;AAOlBmC,UAAQ,gBAAUrB,OAAV,EAAmBuB,KAAnB,EAA0BC,KAA1B,EAAiC/B,KAAjC,EAAwC;AAC9C,QAAI,CAAC8B,MAAME,SAAN,EAAL,EAAwB,OAAOjC,eAAP;AACxB,WAAO,MAAP;AACD,GAViB;AAWlB,kBAAgB,qBAAUQ,OAAV,EAAmBuB,KAAnB,EAA0BC,KAA1B,EAAiC/B,KAAjC,EAAwC;AACtD,WAAO,CAAP;AACD,GAbiB;;AAelB;;;;;AAKA,iBAAe,CACb,QADa,EAEb,UAAUO,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrC,QAAI8B,QAAQrB,KAAKwB,KAAjB;AACA,QAAI,CAACH,MAAMI,kBAAN,MAA8BJ,MAAMK,mBAAN,EAA/B,KAA+D,CAACL,MAAMM,qBAAN,EAApE,EAAmG,OAAO,QAAP;AACpG,GALY,CApBG;;AA4BlB;;;;;;;;AAQA,oBAAkB,CApCA;;AAsClBC,cAAY,oBAAU9B,OAAV,EAAmBE,IAAnB,EAAyB;AACnC,QAAI,CAACA,KAAKwB,KAAL,CAAWK,uBAAX,EAAL,EAA2C,OAAO,QAAP;AAC5C;AAxCiB,CAApB;;AA2CA;;;;AAIA,IAAMC,eAAeC,QAAQC,aAAR,GAAwB;AAC3ClB,MAAI,CADuC;AAE3CC,MAAI,CAFuC;AAG3CC,KAAG,CACD,CADC,EAED,UAAUlB,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrC,WAAOA,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,CAAP;AACD,GAJA,EAKD,UAAUc,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrC,QAAI8B,QAAQrB,KAAKwB,KAAjB;AACA,QAAIS,UAAU,IAAd;AACAZ,UAAMa,WAAN,GAAoBC,OAApB,CAA4B,UAAUC,OAAV,EAAmB;AAC7C,UAAIA,QAAQC,KAAR,IAAiBD,QAAQC,KAAR,CAAcC,UAAd,KAA6B,CAAlD,EAAqDL,UAAU,KAAV;AACtD,KAFD;AAGA,QAAIA,WAAW,CAACZ,MAAMQ,uBAAN,EAAhB,EAAiD;AAC/C,aAAO,MAAMtC,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,GAAlC,CAAb;AACD;AACF,GAdA,CAHwC;AAmB3CmC,UAAQ,MAnBmC;AAoB3CS,cAAY,oBAAU9B,OAAV,EAAmBE,IAAnB,EAAyB;AACnC,QAAIF,QAAQd,KAAR,GAAgB,GAApB,EAAyB,OAAO,QAAP;AACzB,QAAIgB,KAAKwB,KAAL,CAAWK,uBAAX,EAAJ,EAA0C,OAAO,QAAP;AAC3C;AAvB0C,CAA7C;;AA0BA;;;;AAIA,IAAMU,SAAS;AACbzB,MAAI,CADS;AAEbC,MAAI,CAFS;AAGbC,KAAG,EAHU;AAIb,kBAAgB,KAJH;AAKbG,UAAQ,MALK;AAMbF,QAAM;AANO,CAAf;;AASA;;;;AAIA,IAAMuB,oBAAoB,sBAAc,EAAd,EAAkBpB,WAAlB,CAA1B;;AAEAoB,kBAAkBZ,UAAlB,GAA+B,IAA/B;;AAEA;;;;AAIA,IAAMa,qBAAqB,sBAAc,EAAd,EAAkBX,YAAlB,CAA3B;;AAEA;;;;AAIA,IAAMY,SAAS;AACb,eAAa,EADA;AAEb,iBAAe,YAFF;AAGb;;;;;AAKA;;;;;;;;;;;;;;;;;;;;AAoBAC,gBAAc,CACZ,CAAC,GAAD,EAAM,GAAN,CADY;AA5BD,CAAf;;AAkCA,IAAMC,gBAAgB;AACpB,eAAa,EADO;AAEpB,iBAAe,YAFK;AAGpBC,SAAO,MAHa;AAIpBC,cAAY;AAJQ,CAAtB;;AAOA;;;;;AAKA,IAAMC,WAAW;AACf5B,UAAQ,CACN,MADM,EAEN,UAAUrB,OAAV,EAAmBM,OAAnB,EAA4B;AAC1B,QAAI,CAACA,QAAQQ,OAAb,EAAsB,OAAOtB,eAAP;AACtB,QAAIc,QAAQ4C,IAAR,KAAiB,SAArB,EAAgC;AAC9B,UAAI5C,QAAQ6C,QAAZ,EAAsB;AACpB,YAAI7C,QAAQ6C,QAAR,CAAiB,CAAjB,EAAoBZ,KAApB,CAA0Ba,gBAA1B,CAA2CC,WAA3C,GAAyDC,SAAzD,CACF,CADE,EAEF,CAFE,MAEK,IAFT,EAEe,OAAO,MAAP;AACf,eAAOhD,QAAQ6C,QAAR,CAAiB,CAAjB,EAAoBZ,KAApB,CAA0BgB,QAA1B,EAAP;AACD;AACF,KAPD,MAOO,IAAIjD,QAAQ4C,IAAR,KAAiB,KAArB,EAA4B;AACjC,aAAO,MAAP;AACD,KAFM,MAEA,IAAI5C,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,SAAxB,CAAJ,EAAwC;AAC7C,aAAO,MAAP;AACD,KAFM,MAEA,IAAIlD,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,eAAxB,CAAJ,EAA8C;AACnD,aAAO,SAAP;AACD,KAFM,MAEA,IAAIlD,QAAQ4C,IAAR,KAAiB,MAArB,EAA6B;AAClC,aAAO,SAAP;AACD;AACF,GApBK,CADO;AAuBf,oBAAkB,CAChB,MADgB,EAEhB,UAAClD,OAAD,EAAUM,OAAV,EAAsB;AACpB,QAAIA,QAAQ4C,IAAR,KAAiB,MAArB,EAA6B,OAAO,OAAP;AAC9B,GAJe,CAvBH;AA6Bf,sBAAoB,CAClB,KADkB,EAElB,UAAUlD,OAAV,EAAmBE,IAAnB,EAAyB;AACvB,QAAII,UAAUJ,IAAd;AACA,QAAII,QAAQ4C,IAAR,KAAiB,MAArB,EAA6B,OAAO,MAAP;AAC7B,QACE5C,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,SAAxB,KACAlD,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,KAAxB,CADA,IAEAlD,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,eAAxB,CAHF,EAIE;AACA,aAAO,MAAP;AACD;AACD,QAAIlD,QAAQmD,SAAR,IAAqBnD,QAAQmD,SAAR,CAAkBC,OAAlB,GAA4B,EAArD,EAAyD;AACvD,UAAIpD,QAAQmD,SAAR,CAAkBC,OAAlB,GAA4B,CAAhC,EAAmC,OAAO,QAAP;AACnC,aAAO,OAAP;AACD;AACF,GAhBiB,CA7BL;AA+Cf,kBAAgB,CACd,EADc,EAEd,UAAU1D,OAAV,EAAmBM,OAAnB,EAA4BkB,KAA5B,EAAmC/B,KAAnC,EAA0C;AACxC,QAAIa,QAAQ4C,IAAR,KAAiB,MAArB,EAA6B,OAAO,CAAP;AAC7B,QAAI5C,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,SAAxB,CAAJ,EAAwC,OAAO,CAAP;AACxC,QAAIlD,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,KAAxB,CAAJ,EAAoC,OAAO,CAAP;AACpC,QAAIlD,QAAQ4C,IAAR,CAAaM,UAAb,CAAwB,eAAxB,CAAJ,EAA8C,OAAO,CAAP;AAC9C,QAAIlD,QAAQqD,IAAR,KAAiB,CAArB,EAAwB,OAAO,CAAP,CALgB,CAKP;AAClC,GARa,CA/CD;AAyDfC,YAAU,CAER,UAAU5D,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrC,QAAIa,UAAUJ,IAAd;AACA,QAAII,QAAQ4C,IAAR,KAAiB,SAArB,EAAgC;AAC9B,aAAO,KAAP;AACD;AACD,QAAI5C,QAAQqD,IAAR,KAAiB,CAArB,EAAwB;AACtB,aAAOlE,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,EAAlC,IAAwC,IAA/C;AACD;AACD,WAAOO,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,EAA/B,EAAmC,EAAnC,IAAyC,IAAhD;AACD,GAXO;AAzDK,CAAjB;;AAwEA;;;;AAIA,IAAM2E,gBAAgB;AACpBxC,UAAQ,MADY;AAEpB,kBAAgB,qBAAUrB,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrD,WAAOA,MAAMC,MAAN,CAAaM,QAAQd,KAArB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,EAAlC,IAAwC,CAAxC,GAA4C,IAAnD;AACD,GAJmB;AAKpBiC,QAAM,MALc;AAMpBnB,WAAS,CACP,MADO,EAEP,UAAUA,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrC,QAAIS,KAAKoC,OAAL,IAAgBpC,KAAKoC,OAAL,CAAaC,KAA7B,IAAsCrC,KAAKoC,OAAL,CAAaC,KAAb,CAAmBC,UAAnB,KACxC,CADE,IAEFtC,KAAKoC,OAAL,CAAaC,KAAb,CAAmBa,gBAAnB,CAAoCC,WAApC,GAAkDC,SAAlD,CAA4D,CAA5D,EAA+D,CAA/D,MACA,IAHF,EAGQ;AACN,aAAO,QAAP;AACD;AACF,GATM;AANW,CAAtB;;AAmBA;;;;AAIA,IAAMQ,eAAe;AACnBzC,UAAQ,MADW;AAEnB,kBAAgB,qBAAUrB,OAAV,EAAmBE,IAAnB,EAAyBsB,KAAzB,EAAgC/B,KAAhC,EAAuC;AACrD,WAAOS,KAAK6D,gBAAL,CAAsB/D,OAAtB,IAAiC,CAAxC;AACD,GAJkB;AAKnB,oBAAkB,OALC;AAMnBmB,QAAM;AANa,CAArB;;AASA;;;;AAIA,IAAM6C,yBAAyB;AAC7B7C,QAAM,cAAUnB,OAAV,EAAmBE,IAAnB,EAAyB;AAC7B,QAAI,CAACA,KAAKuB,SAAL,EAAL,EAAuB,OAAOjC,eAAP;AACxB,GAH4B;AAI7B,kBAAgB,qBAAUQ,OAAV,EAAmBE,IAAnB,EAAyB;AACvC,QAAIA,KAAK+D,MAAL,CAAY3B,OAAZ,IAAuBpC,KAAK+D,MAAL,CAAY3B,OAAZ,CAAoBC,KAApB,CAA0Ba,gBAA1B,CAA2CC,WAA3C,GACxBC,SADwB,CACd,CADc,EACX,CADW,MACJ,IADvB,EAC6B,OAAO,CAAP;AAC7B,WAAO,CAAP;AACD,GAR4B;AAS7BY,MAAI,CATyB;AAU7BC,MAAI;AAVyB,CAA/B;;kBAae;AACb1E,cADa;AAEb2E,mBAAiBhD,cAFJ;AAGbiD,sBAAoBtD,iBAHP;AAIbuD,gBAAchD,WAJD;AAKbY,iBAAeF,YALF;AAMbS,gBANa;AAOb8B,sBAAoB7B,iBAPP;AAQb8B,uBAAqB7B,kBARR;AASbC,gBATa;AAUbK,oBAVa;AAWbwB,kBAAgBZ,aAXH;AAYba,iBAAeZ,YAZF;AAaba,kBAAgB7B,aAbH;AAcb8B,4BAA0BZ;AAdb,C","file":"styles.js","sourcesContent":["import d3 from 'd3'\n\n/**\n * Scales for utility functions to use\n */\n\nconst zoomScale = d3.scale.linear().domain([0.25, 1, 4])\nconst strokeScale = d3.scale.linear().domain([0.25, 1, 4]).range([5, 12, 19])\nconst fontScale = d3.scale.linear().domain([0.25, 1, 4]).range([10, 14, 18])\n\nvar notFocusedColor = '#e0e0e0'\n\n/**\n * Expose `utils` for the style functions to use\n */\n\nconst utils = {\n  pixels: function (zoom, min, normal, max) {\n    return zoomScale.range([min, normal, max])(zoom)\n  },\n  strokeWidth: function (display) {\n    return strokeScale(display.scale)\n  },\n  fontSize: function (display, data) {\n    return Math.floor(fontScale(display.scale))\n  },\n  defineSegmentCircleMarker: function (display, segment, radius, fillColor) {\n    var markerId = 'circleMarker-' + segment.getId()\n    display.svg.append('defs').append('svg:marker')\n      .attr('id', markerId)\n      .attr('refX', radius)\n      .attr('refY', radius)\n      .attr('markerWidth', radius * 2)\n      .attr('markerHeight', radius * 2)\n      .attr('markerUnits', 'userSpaceOnUse')\n      .append('svg:circle')\n      .attr('cx', radius)\n      .attr('cy', radius)\n      .attr('r', radius)\n      .attr('fill', segment.focused ? fillColor : notFocusedColor)\n\n    return 'url(#' + markerId + ')'\n  }\n}\n\n/**\n * Default Wireframe Edge/Vertex Rules\n */\n\nconst wireframeVertices = {\n  cx: 0,\n  cy: 0,\n  r: 3,\n  fill: '#000'\n}\n\nconst wireframeEdges = {\n  stroke: '#444',\n  'stroke-width': 2,\n  'stroke-dasharray': '3px 2px',\n  fill: 'none'\n}\n\n/**\n * Default Merged Stops Rules\n */\n\nconst stopsMerged = {\n  fill: function (display, point, index, utils) {\n    return '#fff'\n  },\n  r: function (display, point, index, utils) {\n    return utils.pixels(display.scale, 8, 12, 16)\n  },\n  stroke: function (display, point, index, utils) {\n    if (!point.isFocused()) return notFocusedColor\n    return '#000'\n  },\n  'stroke-width': function (display, point, index, utils) {\n    return 2\n  },\n\n  /**\n   *  Transitive-specific attribute specifying the shape of the main stop marker.\n   *  Can be 'roundedrect', 'rectangle' or 'circle'\n   */\n\n  'marker-type': [\n    'circle',\n    function (display, data, index, utils) {\n      var point = data.owner\n      if ((point.containsBoardPoint() || point.containsAlightPoint()) && !point.containsTransferPoint()) return 'circle'\n    }\n  ],\n\n  /**\n   *  Transitive-specific attribute specifying any additional padding, in pixels,\n   *  to apply to main stop marker. A value of zero (default) results in a that\n   *  marker is flush to the edges of the pattern segment(s) the point is set against.\n   *  A value greater than zero creates a marker that is larger than the width of\n   *  the segments(s).\n   */\n\n  'marker-padding': 3,\n\n  visibility: function (display, data) {\n    if (!data.owner.containsSegmentEndPoint()) return 'hidden'\n  }\n}\n\n/**\n * Stops Along a Pattern\n */\n\nconst stopsPattern = exports.stops_pattern = {\n  cx: 0,\n  cy: 0,\n  r: [\n    4,\n    function (display, data, index, utils) {\n      return utils.pixels(display.scale, 1, 2, 4)\n    },\n    function (display, data, index, utils) {\n      var point = data.owner\n      var busOnly = true\n      point.getPatterns().forEach(function (pattern) {\n        if (pattern.route && pattern.route.route_type !== 3) busOnly = false\n      })\n      if (busOnly && !point.containsSegmentEndPoint()) {\n        return 0.5 * utils.pixels(display.scale, 2, 4, 6.5)\n      }\n    }\n  ],\n  stroke: 'none',\n  visibility: function (display, data) {\n    if (display.scale < 1.5) return 'hidden'\n    if (data.owner.containsSegmentEndPoint()) return 'hidden'\n  }\n}\n\n/**\n * Default place rules\n */\n\nconst places = {\n  cx: 0,\n  cy: 0,\n  r: 14,\n  'stroke-width': '2px',\n  stroke: '#000',\n  fill: '#fff'\n}\n\n/**\n * Default MultiPoint rules -- based on Stop rules\n */\n\nconst multipointsMerged = Object.assign({}, stopsMerged)\n\nmultipointsMerged.visibility = true\n\n/**\n * Default Multipoint Stops along a pattern\n */\n\nconst multipointsPattern = Object.assign({}, stopsPattern)\n\n/**\n * Default label rules\n */\n\nconst labels = {\n  'font-size': 15,\n  'font-family': 'sans-serif',\n  /*'font-weight': function (display, data, index, utils) {\n    var point = data.owner.parent\n    if (point.containsBoardPoint() || point.containsAlightPoint()) return 'bold'\n  },*/\n\n  /**\n   * 'orientations' is a transitive-specific attribute used to specify allowable\n   * label placement orientations expressed as one of eight compass directions\n   * relative to the point being labeled:\n   *\n   *        'N'\n   *    'NW' |  'NE'\n   *       \\ | /\n   *  'W' -- O -- 'E'\n   *       / | \\\n   *    'SW' | 'SE'\n   *        'S\n   *\n   * Labels oriented 'E' or 'W' are rendered horizontally, 'N' and 'S' vertically,\n   * and all others at a 45-degree angle.\n   *\n   * Returns an array of allowed orientation codes in the order that they will be\n   * tried by the labeler.\n   */\n\n  orientations: [\n    ['E', 'W']\n  ]\n}\n\n\nconst segmentLabels = {\n  'font-size': 15,\n  'font-family': 'sans-serif',\n  color: '#fff',\n  background: '#008'\n}\n\n/**\n * All path segments\n * TODO: update old route-pattern-specific code below\n */\n\nconst segments = {\n  stroke: [\n    '#008',\n    function (display, segment) {\n      if (!segment.focused) return notFocusedColor\n      if (segment.type === 'TRANSIT') {\n        if (segment.patterns) {\n          if (segment.patterns[0].route.route_short_name.toLowerCase().substring(\n            0,\n            2) === 'dc') return '#f00'\n          return segment.patterns[0].route.getColor()\n        }\n      } else if (segment.type === 'CAR') {\n        return '#888'\n      } else if (segment.type.startsWith('BICYCLE')) {\n        return '#f00'\n      } else if (segment.type.startsWith('MICROMOBILITY')) {\n        return '#f5a729'\n      } else if (segment.type === 'WALK') {\n        return '#86cdf9'\n      }\n    }\n  ],\n  'stroke-linecap': [\n    'butt',\n    (display, segment) => {\n      if (segment.type === 'WALK') return 'round'\n    }\n  ],\n  'stroke-dasharray': [\n    false,\n    function (display, data) {\n      var segment = data\n      if (segment.type === 'WALK') return '0, 8'\n      if (\n        segment.type.startsWith('BICYCLE') ||\n        segment.type.startsWith('CAR') ||\n        segment.type.startsWith('MICROMOBILITY')\n      ) {\n        return '8, 3'\n      }\n      if (segment.frequency && segment.frequency.average < 12) {\n        if (segment.frequency.average > 6) return '12, 12'\n        return '12, 2'\n      }\n    }\n  ],\n  'stroke-width': [\n    10,\n    function (display, segment, index, utils) {\n      if (segment.type === 'WALK') return 6\n      if (segment.type.startsWith('BICYCLE')) return 4\n      if (segment.type.startsWith('CAR')) return 4\n      if (segment.type.startsWith('MICROMOBILITY')) return 4\n      if (segment.mode === 3) return 6 // Buses\n    }\n  ],\n  envelope: [\n\n    function (display, data, index, utils) {\n      var segment = data\n      if (segment.type !== 'TRANSIT') {\n        return '8px'\n      }\n      if (segment.mode === 3) {\n        return utils.pixels(display.scale, 4, 6, 10) + 'px'\n      }\n      return utils.pixels(display.scale, 6, 10, 14) + 'px'\n    }\n  ]\n}\n\n/**\n * Segments Front\n */\n\nconst segmentsFront = {\n  stroke: '#008',\n  'stroke-width': function (display, data, index, utils) {\n    return utils.pixels(display.scale, 3, 6, 10) / 2 + 'px'\n  },\n  fill: 'none',\n  display: [\n    'none',\n    function (display, data, index, utils) {\n      if (data.pattern && data.pattern.route && data.pattern.route.route_type ===\n        3 &&\n        data.pattern.route.route_short_name.toLowerCase().substring(0, 2) ===\n        'dc') {\n        return 'inline'\n      }\n    }\n  ]\n}\n\n/**\n * Segments Halo\n */\n\nconst segmentsHalo = {\n  stroke: '#fff',\n  'stroke-width': function (display, data, index, utils) {\n    return data.computeLineWidth(display) + 8\n  },\n  'stroke-linecap': 'round',\n  fill: 'none'\n}\n\n/**\n * Label Containers\n */\n\nconst segmentLabelContainers = {\n  fill: function (display, data) {\n    if (!data.isFocused()) return notFocusedColor\n  },\n  'stroke-width': function (display, data) {\n    if (data.parent.pattern && data.parent.pattern.route.route_short_name.toLowerCase()\n      .substring(0, 2) === 'dc') return 1\n    return 0\n  },\n  rx: 3,\n  ry: 3\n}\n\nexport default {\n  utils,\n  wireframe_edges: wireframeEdges,\n  wireframe_vertices: wireframeVertices,\n  stops_merged: stopsMerged,\n  stops_pattern: stopsPattern,\n  places,\n  multipoints_merged: multipointsMerged,\n  multipoints_pattern: multipointsPattern,\n  labels,\n  segments,\n  segments_front: segmentsFront,\n  segments_halo: segmentsHalo,\n  segment_labels: segmentLabels,\n  segment_label_containers: segmentLabelContainers\n}\n"]}